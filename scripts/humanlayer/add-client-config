#!/bin/bash
# add-client-config - Add a new client-specific thoughts profile
# Usage: add-client-config <client-name> [thoughts-repo-path]

set -e

CLIENT_NAME="$1"
THOUGHTS_REPO="${2-}"

if [ -z "$CLIENT_NAME" ]; then
    echo "Usage: add-client-config <client-name> [thoughts-repo-path]"
    exit 1
fi

# Sanitize client name
CLIENT_NAME=$(echo "$CLIENT_NAME" | tr '[:upper:]' '[:lower:]' | tr ' ' '-')

# Get thoughts repo path if not provided
if [ -z "$THOUGHTS_REPO" ]; then
    echo "Where should this client's thoughts be stored?"
    read -p "Thoughts repository path: " THOUGHTS_REPO
fi

# Expand tilde and make absolute
THOUGHTS_REPO="${THOUGHTS_REPO/#\~/$HOME}"
if [[ $THOUGHTS_REPO != /* ]]; then
    THOUGHTS_REPO="$(pwd)/$THOUGHTS_REPO"
fi

# Create profile using HumanLayer CLI
echo "Creating profile: $CLIENT_NAME"
echo "Thoughts repo: $THOUGHTS_REPO"
echo ""

humanlayer thoughts profile create "$CLIENT_NAME" --repo "$THOUGHTS_REPO"

echo ""
echo "Profile created! To use:"
echo "  cd /path/to/project"
echo "  humanlayer thoughts init --profile $CLIENT_NAME"
